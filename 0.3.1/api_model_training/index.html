
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content=""Automated analysis of muscle architecture in ultrasonography images and videos using deep learning"">
      
      
      
      
        <link rel="prev" href="../api_advanced_analysis/">
      
      
        <link rel="next" href="../api_helpers/">
      
      
        
      
      
      <link rel="icon" href="../md_graphics/DLTrack_logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Model Training - DL_Track_US</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../overrides/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model_training" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DL_Track_US" class="md-header__button md-logo" aria-label="DL_Track_US" data-md-component="logo">
      
  <img src="../md_graphics/DLTrack_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DL_Track_US
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Model Training
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/PaulRitsche/DL_Track_US" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    DL_Track_US
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DL_Track_US" class="md-nav__button md-logo" aria-label="DL_Track_US" data-md-component="logo">
      
  <img src="../md_graphics/DLTrack_logo.png" alt="logo">

    </a>
    DL_Track_US
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PaulRitsche/DL_Track_US" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    DL_Track_US
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../news/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    News
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../automated_image_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Automated Image Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../manual_image_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manual Image Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../automated_video_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Automated Video Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../manual_video_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manual Video Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Methods
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Methods
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training_your_own_networks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Training Your Own Networks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inspecting_masks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inspecting Masks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crop_video/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Crop Video
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../remove_video_parts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Remove Video Parts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../resize_video/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resize Video
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tests
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tests
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../automated_image_analysis_test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Automated Image Analysis Test
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../manual_image_video_analysis_test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manual Img/Vid Analysis Test
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../automated_video_analysis_test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Automated Video Analysis Test
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model_training_test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Training Test
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../code_of_conduct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code of Conduct
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about_us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About Us
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DL_Track_US
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_advanced_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Model Training
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Training
  

    
  </span>
  
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model_training" class="md-nav__link">
    <span class="md-ellipsis">
      
        model_training
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training" class="md-nav__link">
    <span class="md-ellipsis">
      
        model_training
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.StopTrainingCallback" class="md-nav__link">
    <span class="md-ellipsis">
      
        StopTrainingCallback
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StopTrainingCallback">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.StopTrainingCallback.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.StopTrainingCallback.on_epoch_begin" class="md-nav__link">
    <span class="md-ellipsis">
      
        on_epoch_begin
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.IoU" class="md-nav__link">
    <span class="md-ellipsis">
      
        IoU
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.build_vgg16_unet" class="md-nav__link">
    <span class="md-ellipsis">
      
        build_vgg16_unet
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.conv_block" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv_block
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.decoder_block" class="md-nav__link">
    <span class="md-ellipsis">
      
        decoder_block
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.dice_score" class="md-nav__link">
    <span class="md-ellipsis">
      
        dice_score
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.focal_loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        focal_loss
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.loadImages" class="md-nav__link">
    <span class="md-ellipsis">
      
        loadImages
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.trainModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        trainModel
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.data_augmentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        data_augmentation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.data_augmentation.image_augmentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        image_augmentation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        file_analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis.collect_images" class="md-nav__link">
    <span class="md-ellipsis">
      
        collect_images
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis.find_outliers" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_outliers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis.overlay_directory_images" class="md-nav__link">
    <span class="md-ellipsis">
      
        overlay_directory_images
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis.redact_images_in_directory" class="md-nav__link">
    <span class="md-ellipsis">
      
        redact_images_in_directory
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis.show_outliers_popup" class="md-nav__link">
    <span class="md-ellipsis">
      
        show_outliers_popup
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GUI helpers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#model_training" class="md-nav__link">
    <span class="md-ellipsis">
      
        model_training
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training" class="md-nav__link">
    <span class="md-ellipsis">
      
        model_training
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.StopTrainingCallback" class="md-nav__link">
    <span class="md-ellipsis">
      
        StopTrainingCallback
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StopTrainingCallback">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.StopTrainingCallback.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.StopTrainingCallback.on_epoch_begin" class="md-nav__link">
    <span class="md-ellipsis">
      
        on_epoch_begin
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.IoU" class="md-nav__link">
    <span class="md-ellipsis">
      
        IoU
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.build_vgg16_unet" class="md-nav__link">
    <span class="md-ellipsis">
      
        build_vgg16_unet
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.conv_block" class="md-nav__link">
    <span class="md-ellipsis">
      
        conv_block
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.decoder_block" class="md-nav__link">
    <span class="md-ellipsis">
      
        decoder_block
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.dice_score" class="md-nav__link">
    <span class="md-ellipsis">
      
        dice_score
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.focal_loss" class="md-nav__link">
    <span class="md-ellipsis">
      
        focal_loss
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.loadImages" class="md-nav__link">
    <span class="md-ellipsis">
      
        loadImages
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.model_training.trainModel" class="md-nav__link">
    <span class="md-ellipsis">
      
        trainModel
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.data_augmentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        data_augmentation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.data_augmentation.image_augmentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        image_augmentation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        file_analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis.collect_images" class="md-nav__link">
    <span class="md-ellipsis">
      
        collect_images
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis.find_outliers" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_outliers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis.overlay_directory_images" class="md-nav__link">
    <span class="md-ellipsis">
      
        overlay_directory_images
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis.redact_images_in_directory" class="md-nav__link">
    <span class="md-ellipsis">
      
        redact_images_in_directory
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DL_Track_US.gui_helpers.file_analysis.show_outliers_popup" class="md-nav__link">
    <span class="md-ellipsis">
      
        show_outliers_popup
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Model Training</h1>

<h3 id="model_training">model_training<a class="headerlink" href="#model_training" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-module">



<a id="DL_Track_US.gui_helpers.model_training"></a>
    <div class="doc doc-contents first">



<details class="description" open>
  <summary>Description</summary>
  <p>This module contains functions to train a VGG16 encoder U-net decoder CNN.
The module was specifically designed to be executed from a GUI.
When used from the GUI, the module saves the trained model and weights to
a given directory. The user needs to provide paths to the image and label/
mask directories. Instructions for correct image labelling can be found
in the Labelling directory.</p>
</details>

<details class="functions-scope" open>
  <summary>Functions scope</summary>
  <p>conv_block
    Function to build a convolutional block for the U-net decoder path of
    the network.
    The block is built using several keras.layers functionalities.
decoder_block
    Function to build a decoder block for the U-net decoder path of
    the network.
    The block is built using several keras.layers functionalities.
build_vgg16_model
    Function that builds a convolutional network consisting of an VGG16
    encoder path and a U-net decoder path.
IoU
    Function to compute the intersection over union score (IoU),
    a measure of prediction accuracy. This is sometimes also called
    Jaccard score.
dice_score
    Function to compute the Dice score, a measure of prediction accuracy.
focal_loss
     Function to compute the focal loss, a measure of prediction accuracy.
load_images
    Function to load images and manually labeled masks from a specified
    directory.
train_model
    Function to train a convolutional neural network with VGG16 encoder and
    U-net decoder. All the steps necessary to properly train a neural
    network are included in this function.</p>
</details>

<details class="note" open>
  <summary>Notes</summary>
  <p>Additional information and usage examples can be found at the respective
functions documentations.</p>
</details>









  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="DL_Track_US.gui_helpers.model_training.StopTrainingCallback" class="doc doc-heading">
            <code>StopTrainingCallback</code>


<a href="#DL_Track_US.gui_helpers.model_training.StopTrainingCallback" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="tensorflow.keras.callbacks.Callback">Callback</span></code></p>



        <p>A custom Keras callback to stop training early based on a GUI signal.</p>
<p>This callback checks the <code>should_stop</code> attribute of a GUI instance at the
beginning of each epoch and stops training if the flag is set to <code>True</code>.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>gui_instance</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The GUI instance that contains the <code>should_stop</code> attribute.
It should be set to <code>True</code> when the user requests training to stop.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="object">object</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">ATTRIBUTE</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="DL_Track_US.gui_helpers.model_training.StopTrainingCallback.gui_instance">gui_instance</span></code></td>
            <td class="doc-attribute-details">
              <div class="doc-md-description">
                <p>Reference to the GUI instance for checking the stopping condition.</p>
              </div>
              <p>
                  <span class="doc-attribute-annotation">
                    <b>TYPE:</b>
                      <code><span title="object">object</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">METHOD</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="on_epoch_begin(epoch, logs=None) (DL_Track_US.gui_helpers.model_training.StopTrainingCallback.on_epoch_begin)" href="#DL_Track_US.gui_helpers.model_training.StopTrainingCallback.on_epoch_begin">on_epoch_begin</a></code></td>
              <td class="doc-function-details">
                <div class="doc-md-description">
                  <p>Checks if <code>should_stop</code> is set to <code>True</code> and stops training if necessary.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequential</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow.keras.layers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dense</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,))])</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">gui_instance</span><span class="o">.</span><span class="n">should_stop</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Simulating a GUI stop flag</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">stop_callback</span> <span class="o">=</span> <span class="n">StopTrainingCallback</span><span class="p">(</span><span class="n">gui_instance</span><span class="p">)</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">stop_callback</span><span class="p">])</span>
</span></code></pre></div>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="DL_Track_US.gui_helpers.model_training.StopTrainingCallback.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">gui_instance</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.model_training.StopTrainingCallback.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">



<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>gui_instance</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The GUI instance containing the <code>should_stop</code> attribute.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="object">object</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="DL_Track_US.gui_helpers.model_training.StopTrainingCallback.on_epoch_begin" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">on_epoch_begin</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">logs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.model_training.StopTrainingCallback.on_epoch_begin" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Called at the beginning of each epoch. Checks if training should stop.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>epoch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The index of the current epoch.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>logs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Dictionary containing training metrics (default is None).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.model_training.IoU" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">IoU</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.model_training.IoU" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Function to compute the intersection over union score (IoU),
a measure of prediction accuracy. This is sometimes also called
Jaccard score.</p>
<p>The IoU can be used as a loss metric during binary segmentation when
convolutional neural networks are applied. The IoU is calculated for
both the training and validation set.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>True positive image segmentation label predefined by the user.
This is the mask that is provided prior to model training.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tensorflow.Tensor">Tensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_pred</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Predicted image segmentation by the network.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tensorflow.Tensor">Tensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Data type of the IoU calculation. The default is tf.float32.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>default = tff.float32</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="tensorflow.float32">float32</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>iou</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>IoU representation in the same shape as y_true, y_pred.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="tensorflow.Tensor">Tensor</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>The IoU is usually calculated as IoU = intersection / union.
The intersection is calculated as the overlap of y_true and
y_pred, whereas the union is the sum of y_true and y_pred.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">IoU</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">Tensor</span><span class="p">(</span><span class="s2">&quot;IteratorGetNext:1&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">),</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">        y_pred=Tensor(&quot;VGG16_U-Net/conv2d_8/Sigmoid:0&quot;,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">        shape=(1, 512, 512, 1), dtype=float32), dtype=float32)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">Tensor(&quot;truediv:0&quot;, shape=(1, 512, 512), dtype=float32)</span>
</span></code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.model_training.build_vgg16_unet" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build_vgg16_unet</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.model_training.build_vgg16_unet" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Function that builds a convolutional network consisting of a VGG16
encoder path and a U-net decoder path.</p>
<p>The model is built using several Tensorflow.Keras functions.
First, the whole VGG16 model is imported and built using pretrained
imagenet weights and the input shape.
Then, the encoder layers are pulled from the model incldung the bridge.
Subsequently the decoder path from the U-net is built.
Lastly, a 1x1 convolution is applied with sigmoid activation
to perform binary segmentation on the input.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Tuple describing the input shape. Must be of shape (...,...,...).
Here we used (512,512,3) as input shape. The image size (512,512,)
can be easily adapted. The channel numer (,,3) is given by the
model and the pretrained weights. We advide the user not to change
the image size segmentation results were best with the predefined
size.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="model">model</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The built VGG16 encoder U-net decoder convolutional network
for binary segmentation on the input.
The model can subsequently be used for training.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>See our paper () and references for more detailed model description</p>
</details>

<details class="references" open>
  <summary>References</summary>
  <p>[1] VGG16: Simonyan, Karen, and Andrew Zisserman. Very deep convolutional networks for large-scale image recognition. arXiv preprint arXiv:1409.1556 (2014)
[2] U-net: Ronneberger, O., Fischer, P. and Brox, T. "U-Net: Convolutional Networks for Biomedical Image Segmentation." arXiv preprint arXiv:1505.04597 (2015)</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.model_training.conv_block" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">conv_block</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">num_filters</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.model_training.conv_block" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Function to build a convolutional block for the U-net decoder path of
the network to be build.
The block is built using several keras.layers functionalities.</p>
<p>Here, we decided to use 'padding = same' and and a convolutional
kernel of 3.
This is adaptable in the code but will influence the model outcome.
The convolutional block consists of two convolutional layers. Each creates
a convolution kernel that is convolved with the layer input to produce a
tensor of outputs.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>inputs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Concattenated Tensorflow.Keras Tensor outputted from previous layer.
The Tensor can be altered by adapting, i.e. the filter numbers but
this will change the model training output.
The input is then convolved using the built kernel.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="KerasTensor">KerasTensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_filters</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Integer variable determining the number of filters used during model
training.
Here, we started with 'num_filers = 512'.
The filter number is halfed each layer.
The number of filters can be adapted in the code.
Must be non-negative and non-zero.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tensorflow.Keras Tensor used during model Training.
The Tensor can be altered by adapting the input paramenters to the
function or the upsampling but this will change the model training.
The number of filters is halfed.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="KerasTensor">KerasTensor</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">conv_block</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">KerasTensor</span><span class="p">(</span><span class="n">type_spec</span><span class="o">=</span><span class="n">TensorSpec</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">               dtype=tf.float32, name=None),</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">               num_filters=128)</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">KerasTensor(type_spec=TensorSpec(shape=(None, 256, 256, 64),</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">dtype=tf.float32, name=None)</span>
</span></code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.model_training.decoder_block" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">decoder_block</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">skip_features</span><span class="p">,</span> <span class="n">num_filters</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.model_training.decoder_block" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Function to build a decoder block for the U-net decoder path
of the network to be build.
The block is build using several keras.layers functionalities.</p>
<p>The block is built by applying a deconvolution (Keras.Conv2DTranspose)
to upsample to input by a factor of 2. A concatenation with the skipped
features from the mirrored vgg16 convolutional layer follows.
Subsequently a convolutional block (see conv_block
function) is applied to convolve the input with the built kernel.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>inputs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Concattenated Tensorflow.Keras Tensor outputted from previous layer.
The Tensor can be altered by adapting, i.e. the filter numbers but
this will change the model training output.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="KerasTensor">KerasTensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_features</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Skip connections to the encoder path of the vgg16 encoder.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>Keras Tensor</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_filters</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Integer variable determining the number of filters used during
model training.
Here, we started with 'num_filers = 512'.
The filter number is halfed each layer. The number of filters can
be adapted in the code. Must be non-neagtive and non-zero.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tensorflow.Keras Tensor used during model Training. The tensor is
upsampled using Keras.Conv2DTranspose with a kernel of (2,2),
'stride=2' and 'padding=same'.
The upsampling increases image size by a factor of 2.
The number of filters is halfed.
The Tensor can be altered by adapting the input paramenters to the
function or the upsampling but this will change the model training.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="KerasTensor">KerasTensor</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">decoder_block</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">KerasTensor</span><span class="p">(</span><span class="n">type_spec</span><span class="o">=</span><span class="n">TensorSpec</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">                  skip_features=KerasTensor(type_spec=TensorSpec(shape=(None, 64, 64, 512),</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">                  dtype=tf.float32, name=None)),</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">                  num_filters=256)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">KerasTensor(type_spec=TensorSpec(shape=(None, 128, 128, 256),</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">dtype=tf.float32, name=None)</span>
</span></code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.model_training.dice_score" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dice_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.model_training.dice_score" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Function to compute the Dice score, a measure of prediction accuracy.</p>
<p>The Dice score can be used as a loss metric during binary segmentation when
convolutional neural networks are applied. The Dice score is calculated
for both the training and validation set.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>True positive image segmentation label predefined by the user.
This is the mask that is provided prior to model training.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tensorflow.Tensor">Tensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_pred</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Predicted image segmentation by the network.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tensorflow.Tensor">Tensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>score</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dice score representation in the same shape as y_true, y_pred.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="tensorflow.Tensor">Tensor</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>The IoU is usually calculated as Dice = 2 * intersection / union.
The intersection is calculated as the overlap of y_true and
y_pred, whereas the union is the sum of y_true and y_pred.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">IoU</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">Tensor</span><span class="p">(</span><span class="s2">&quot;IteratorGetNext:1&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">        dtype=float32),</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">        y_pred=Tensor(&quot;VGG16_U-Net/conv2d_8/Sigmoid:0&quot;,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">        shape=(1, 512, 512, 1), dtype=float32),</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">        smooth=1)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">Tensor(&quot;dice_score/truediv:0&quot;, shape=(1, 512, 512), dtype=float32)</span>
</span></code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.model_training.focal_loss" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">focal_loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.model_training.focal_loss" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Function to compute the focal loss, a measure of prediction accuracy.</p>
<p>The focal loss can be used as a loss metric during binary segmentation when
convolutional neural networks are applied. The focal loss score is
calculated for both, the training and validation set. The focal loss
is specifically applicable when class imbalances, i.e. between foregroung
(muscle aponeurosis) and background (not muscle aponeurosis), are existent.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>y_true</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>True positive image segmentation label predefined by the user.
This is the mask that is provided prior to model training.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tensorflow.Tensor">Tensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_pred</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Predicted image segmentation by the network.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tensorflow.Tensor">Tensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Coefficient used on positive exaples, must be non-negative and
non-zero.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>= 0.8</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gamma</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Focussing parameter, must be non-negative and non-zero.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>= 2</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f_loss</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tensor containing the calculated focal loss score.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="tensorflow.Tensor">Tensor</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">focal_loss</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">Tensor</span><span class="p">(</span><span class="s2">&quot;IteratorGetNext:1&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">        dtype=float32),</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">        y_pred=Tensor(&quot;VGG16_U-Net/conv2d_8/Sigmoid:0&quot;,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">        shape=(1, 512, 512, 1), dtype=float32),</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">        smooth=1)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="go">Tensor(&quot;focal_loss/Mean:0&quot;, shape=(), dtype=float32)</span>
</span></code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.model_training.loadImages" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loadImages</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="n">mask_path</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.model_training.loadImages" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Function to load images and manually labeled masks from a specified
directory.</p>
<p>The images and masks are loaded, resized and normalized in order
to be suitable and usable for model training. The specified directories
must lead to the images and masks. The number of images and masks must be
equal. The images and masks can be in any common image format.
The names of the images and masks must match. The image and corresponding
mask must have the same name.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>img_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path that leads to the directory containing the training images.
Image must be in RGB format.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mask_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path that leads to the directory containing the mask images.
Masks must be binary.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>train_imgs</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Resized, normalized training images stored in a numpy array.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="numpy.ndarray">ndarray</span></code>
                  </span>
                </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mask_imgs</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Resized, normalized training masks stored in a numpy array.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="numpy.ndarray">ndarray</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>See labelling instruction for correct masks creation and use,
if needed, the supplied ImageJ script to label your images.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">loadImages</span><span class="p">(</span><span class="n">img_path</span> <span class="o">=</span> <span class="s2">&quot;C:/Users/admin/Dokuments/images&quot;</span><span class="p">,</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">               mask_path = &quot;C:/Users/admin/Dokuments/masks&quot;)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">train_imgs([[[[0.22414216 0.19730392 0.22414216] ... [0.22414216 0.19730392 0.22414216]]])</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">mask_imgs([[[[0.] ... [0.]]])</span>
</span></code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.model_training.trainModel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trainModel</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="n">mask_path</span><span class="p">,</span> <span class="n">out_path</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">gui</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.model_training.trainModel" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Function to train a convolutional neural network with VGG16 encoder and
U-net decoder. All the steps necessary to properly train an neural
network are included in this function.</p>
<p>This functions build upon all the other functions included in this module.
Given that all input parameters are correctly specified, the images and
masks are loaded, splittet into test and training sets, the model is
compiled according to user specification and the model is trained.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>img_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path that leads to the directory containing the training images.
Image must be in RGB format.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mask_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path that leads to the directory containing the mask images.
Masks must be binary.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>out_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path that leads to the directory where the trained model is saved.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Integer value that determines the batch size per iteration through the
network during model training. Although a larger batch size has
advantages during model trainig, the images used here are large. Thus,
the larger the batch size, the more compute power is needed or the
longer the training duration. Must be non-negative and non-zero.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>learning_rate</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Float value determining the learning rate used during model training.
Must be non-negative and non-zero.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>epochs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Integer value that determines the amount of epochs that the model
is trained befor training is aborted. The total amount of epochs
will only be used if early stopping does not happen.
Must be non-negative and non-zero.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>String variable that determines the loss function used during training.
So far, only one type is supported here:
- Binary cross-entropy. loss == "BCE"</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="BCE">BCE</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>&#34;BCE&#34;</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gui</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A tkinter.TK class instance that represents a GUI. By passing this
argument, interaction with the GUI is possible i.e., stopping
the model training model process.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tkinter.TK">TK</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>For specific explanations for the included functions see the respective
function docstrings in this module.
This function can either be run from the command prompt or is called
by the GUI. Note that the functioned was specifically designed to be
called from the GUI. Thus, tk.messagebox will pop up when errors are
raised even if the GUI is not started.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">trainModel</span><span class="p">(</span><span class="n">img_path</span><span class="o">=</span> <span class="s2">&quot;C:/Users/admin/Dokuments/images&quot;</span><span class="p">,</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">               mask_path=&quot;C:/Users/admin/Dokuments/masks&quot;,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">               out_path=&quot;C:/Users/admin/Dokuments/results&quot;,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">               batch_size=1, learning_rate=0.005,</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">               epochs=3, loss=&quot;BCE&quot;, gui)</span>
</span></code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="DL_Track_US.gui_helpers.data_augmentation"></a>
    <div class="doc doc-contents first">



<details class="description" open>
  <summary>Description</summary>
  <p>Python module which contains a function, which allows to generate new training images
from the input images. The newly generated data will be saved under the same directories
as the input data.</p>
<p>This module provides a function, image_augmentation, that performs data augmentation on
input images and their corresponding masks to generate new training data for machine
learning models. Data augmentation is a common technique used to artificially increase
the diversity of the training dataset by applying various transformations to the original images.</p>
</details>

<details class="functions-scope" open>
  <summary>Functions scope</summary>
  <p>image_augmentation
    Function, which generates new training data from the input images through data augmentation.</p>
</details>









  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.data_augmentation.image_augmentation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">image_augmentation</span><span class="p">(</span><span class="n">input_img_folder</span><span class="p">,</span> <span class="n">input_mask_folder</span><span class="p">,</span> <span class="n">gui</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.data_augmentation.image_augmentation" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Function, which generates new training data from the input images through data augmentation.
At the moment the number of added images is set to five.
Perform data augmentation on images and masks in the specified input directories.</p>
<p>The function applies data augmentation techniques to the images and masks located in the specified
input directories. It creates augmented images and masks based on various augmentation parameters,
and saves the augmented images and masks back to their respective input directories.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input_img_folder</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path to the folder containing the original input images.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>input_mask_folder</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path to the folder containing the original input masks corresponding to the images.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gui</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The main tkinter GUI object to display information to the user.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tkinter.Tk">Tk</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>Although nothing is returned, the images in the input folders will be augmented three-fold.</li>
<li>The function uses the Keras ImageDataGenerator for data augmentation.</li>
<li>Augmented images and masks will be saved to their respective input directories with
  filenames prefixed with numbers representing the index of the original images.</li>
<li>The function will display information to the user in the specified tkinter GUI.</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">image_augmentation</span><span class="p">(</span><span class="s2">&quot;data/images/&quot;</span><span class="p">,</span> <span class="s2">&quot;data/masks/&quot;</span><span class="p">,</span> <span class="n">root</span>
</span></code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="DL_Track_US.gui_helpers.file_analysis"></a>
    <div class="doc doc-contents first">

        <p>Module to perform analysis of image files used for training model</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.file_analysis.collect_images" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">collect_images</span><span class="p">(</span><span class="n">root_dir</span><span class="p">,</span> <span class="n">target_dir</span><span class="p">,</span> <span class="n">image_type</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.file_analysis.collect_images" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Searches through the root directory and its subdirectories for images of the
specified type and copies them to the target directory with modified names to
avoid overwriting. The modified name format is original_filename_n.extension, where
n starts from 0.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>root_dir</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The root directory to search for images.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>target_dir</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The directory where found images will be stored.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>image_type</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The type of the images to search for (e.g., 'jpg', 'png', 'tiff').</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>The function creates the target directory if it does not already exist.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.file_analysis.find_outliers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_outliers</span><span class="p">(</span><span class="n">dir1</span><span class="p">,</span> <span class="n">dir2</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.file_analysis.find_outliers" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Find image filenames that do not occur in both directories and
check if both directories have the same number of images.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dir1</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path to the first directory containing images.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dir2</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path to the second directory containing images.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>DataFrame</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A DataFrame with columns:
- 'Outlier Image': Names of the outlier images.
- 'Directory': The directory in which the outlier was found.
- 'Images in Dir1': The number of images in dir1.
- 'Images in Dir2': The number of images in dir2.</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.dataframe">dataframe</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">find_outliers</span><span class="p">(</span><span class="s1">&#39;/path/to/dir1&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/dir2&#39;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="go">              Outlier Image         Directory  Images in Dir1  Images in Dir2</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="go">0           image3.jpg      /path/to/dir1            NaN                 NaN</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="go">1           image4.jpg      /path/to/dir2            NaN                 NaN</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="go">2           NaN                 NaN                     5                   4</span>
</span></code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.file_analysis.overlay_directory_images" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">overlay_directory_images</span><span class="p">(</span><span class="n">image_dir</span><span class="p">,</span> <span class="n">mask_dir</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.file_analysis.overlay_directory_images" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Overlay binary masks on ultrasound images from given directories.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>image_dir</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory containing the ultrasound images.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mask_dir</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory containing the corresponding binary masks.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>alpha</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Opacity level of the mask when overlaid on the ultrasound. Default is 0.5.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0.5</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start_index</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Index to start displaying the image/mask pairs. Default is 0 (first image).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Displays an interactive plot of overlaid image pairs.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="language-pycon highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">overlay_directory_images</span><span class="p">(</span><span class="s1">&#39;/path/to/ultrasound_images/&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/masks/&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span></code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.file_analysis.redact_images_in_directory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">redact_images_in_directory</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.file_analysis.redact_images_in_directory" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Redacts the upper 50 pixels of every image in the specified directory by
drawing a black rectangle over them. The images are saved under the same
names in the same directory.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The path to the directory containing the images to be redacted.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DL_Track_US.gui_helpers.file_analysis.show_outliers_popup" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">show_outliers_popup</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dir1</span><span class="p">,</span> <span class="n">dir2</span><span class="p">)</span></code>

<a href="#DL_Track_US.gui_helpers.file_analysis.show_outliers_popup" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Display a pop-up window with a table showing outlier images between two directories.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>df</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>DataFrame containing outlier information.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="pandas.DataFrame">DataFrame</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dir1</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path to the first directory containing images.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dir2</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path to the second directory containing images.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="April 7, 2025 18:17:13 CEST">April 7, 2025</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="April 7, 2025 18:17:13 CEST">April 7, 2025</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 - 2025. DL_Track_US - <a href="#__consent">Change cookie settings</a>

    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/PaulRitsche/DL_Track_US" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.researchgate.net/profile/Paul-Ritsche" target="_blank" rel="noopener" title="www.researchgate.net" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M0 32v448h448V32zm262.2 334.4c-6.6 3-33.2 6-50-14.2-9.2-10.6-25.3-33.3-42.2-63.6-8.9 0-14.7 0-21.4-.6v46.4c0 23.5 6 21.2 25.8 23.9v8.1c-6.9-.3-23.1-.8-35.6-.8-13.1 0-26.1.6-33.6.8v-8.1c15.5-2.9 22-1.3 22-23.9V225c0-22.6-6.4-21-22-23.9V193c25.8 1 53.1-.6 70.9-.6 31.7 0 55.9 14.4 55.9 45.6 0 21.1-16.7 42.2-39.2 47.5 13.6 24.2 30 45.6 42.2 58.9 7.2 7.8 17.2 14.7 27.2 14.7zm22.9-135c-23.3 0-32.2-15.7-32.2-32.2V167c0-12.2 8.8-30.4 34-30.4s30.4 17.9 30.4 17.9l-10.7 7.2s-5.5-12.5-19.7-12.5c-7.9 0-19.7 7.3-19.7 19.7v26.8c0 13.4 6.6 23.3 17.9 23.3 14.1 0 21.5-10.9 21.5-26.8h-17.9v-10.7h30.4c0 20.5 4.7 49.9-34 49.9m-116.5 44.7c-9.4 0-13.6-.3-20-.8v-69.7c6.4-.6 15-.6 22.5-.6 23.3 0 37.2 12.2 37.2 34.5 0 21.9-15 36.6-39.7 36.6"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/ritpau" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



<h4>Cookie consent</h4>
<p>We use only the minimum cookies required by GitHub to ensure our website functions smoothly. You can disable them anytime, because your privacy is our priority!</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>